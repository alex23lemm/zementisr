<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Alexander Lemm" />


<title>zementisr Quickstart Guide</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">zementisr Quickstart Guide</h1>
<h4 class="author">Alexander Lemm</h4>



<p>zementisr is an R client for the Zementis Server API. Zementis Server is an execution engine for PMML models which also comes with model management capabilities.</p>
<p>In this quickstart guide we will show how you can use zementisr to deploy PMML models to Zementis Server, predict new values by sending data to the server and manage the entire PMML model life cycle without leaving your preferred R development environment.</p>
<div id="authentication" class="section level2">
<h2>Authentication</h2>
<p>Zementis Server’s REST API uses HTTP Basic Authentication. For each request the client needs to provide username and password.</p>
<p>Since typing your password in the console is a bit too dangerous (you might accidentally share the <code>.Rhistory</code> file) and asking each time gets too cumbersome quickly, the zementisr package requires that you store your secrets and the base URL of your Zementis Server as environment variables in the <code>.Renviron</code> file in your home directory.</p>
<p>Please make sure to set the environment variables below in your <code>.Renviron</code> file before using functions from the zementisr package. You can easily edit <code>.Renviron</code> using <code>usethis::edit_r_environ()</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">ZEMENTIS_base_url =<span class="st"> &quot;https://localhost:9083/adapars&quot;</span></a>
<a class="sourceLine" id="cb1-2" title="2">ZEMENTIS_usr =<span class="st"> &quot;guybrush.threepwood&quot;</span></a>
<a class="sourceLine" id="cb1-3" title="3">ZEMENTIS_pwd =<span class="st"> &quot;bigwhoop&quot;</span></a></code></pre></div>
</div>
<div id="preparation" class="section level2">
<h2>Preparation</h2>
<p>Before we get started using the zementisr package, we will create two simple prediction models and convert them to PMML using <code>pmml()</code> from the <a href="https://cran.r-project.org/web/packages/pmml/index.html">pmml package</a>. The first PMML model will be saved to disk:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(rpart)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">library</span>(pmml)</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4">iris_lm &lt;-<span class="st"> </span><span class="kw">lm</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>iris)</a>
<a class="sourceLine" id="cb2-5" title="5">iris_pmml &lt;-<span class="st"> </span><span class="kw">pmml</span>(iris_lm, <span class="dt">model_name =</span> <span class="st">&quot;iris_model&quot;</span>)</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw">saveXML</span>(iris_pmml, <span class="st">&quot;iris_pmml.xml&quot;</span>)</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; [1] &quot;iris_pmml.xml&quot;</span></a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9">kyphosis_fit &lt;-<span class="st"> </span><span class="kw">rpart</span>(Kyphosis <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Number <span class="op">+</span><span class="st"> </span>Start, <span class="dt">data =</span> kyphosis)</a>
<a class="sourceLine" id="cb2-10" title="10">kyphosis_pmml &lt;-<span class="st"> </span><span class="kw">pmml</span>(kyphosis_fit, <span class="dt">model_name =</span> <span class="st">&quot;kyphosis_model&quot;</span>)</a></code></pre></div>
</div>
<div id="model-deployment" class="section level2">
<h2>Model deployment</h2>
<p>Now, we will start using functions from the zementisr package. We will begin with <code>upload_model()</code> to upload our PMML models to the server.</p>
<p><code>upload_model()</code> either accepts a path to a PMML file on disk or an <code>XMLNode</code> object created with <code>pmml::pmml()</code>. Below we will demonstrate both options to upload the two models to the server. A successful upload always returns a list with the model name and its activation status.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(zementisr)</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">upload_model</span>(<span class="st">&quot;iris_pmml.xml&quot;</span>)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; $model_name</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; [1] &quot;iris_model&quot;</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; $is_active</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="kw">upload_model</span>(kyphosis_pmml)</a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; $model_name</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; [1] &quot;kyphosis_model&quot;</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt; $is_active</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
</div>
<div id="basic-model-operations" class="section level2">
<h2>Basic model operations</h2>
<p>After deployment you might be interested in how many PMML models are currently deployed to Zementis Server:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">get_models</span>()</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt; [1] &quot;iris_model&quot;     &quot;kyphosis_model&quot;</span></a></code></pre></div>
<p>Use <code>get_model_properties()</code> to get the PMML model’s name, description, input and output field properties:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">get_model_properties</span>(<span class="st">&quot;kyphosis_model&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; $modelName</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt; [1] &quot;kyphosis_model&quot;</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt; $description</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt; [1] &quot;RPart Decision Tree Model&quot;</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; $creationDate</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; [1] &quot;2019-11-03 21:56:50&quot;</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt; $isActive</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt; $inputFields</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt;     name   type  usage</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt; 1    Age DOUBLE ACTIVE</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt; 2 Number DOUBLE ACTIVE</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt; 3  Start DOUBLE ACTIVE</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt; $outputFields</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">#&gt;                  name   type  usage</span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#&gt; 1  Predicted_Kyphosis STRING OUTPUT</span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">#&gt; 2  Probability_absent DOUBLE OUTPUT</span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">#&gt; 3 Probability_present DOUBLE OUTPUT</span></a></code></pre></div>
<p>If you like to deactivate a PMML model without removing it from the server, do the following:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">deactivate_model</span>(<span class="st">&quot;iris_model&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; $model_name</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt; [1] &quot;iris_model&quot;</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; $is_active</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="kw">deactivate_model</span>(<span class="st">&quot;kyphosis_model&quot;</span>)</a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; $model_name</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; [1] &quot;kyphosis_model&quot;</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt; $is_active</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>You even can add some <code>magrittr</code> and <code>purrr</code> flavor to chain several zementisr functions together. For instance, the following line of code lets you activate all your PMML models at once:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">get_models</span>() <span class="op">%&gt;%</span><span class="st"> </span>purrr<span class="op">::</span><span class="kw">map_df</span>(activate_model)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt; # A tibble: 2 x 2</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt;   model_name     is_active</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt;   &lt;chr&gt;          &lt;lgl&gt;    </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; 1 iris_model     TRUE     </span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; 2 kyphosis_model TRUE</span></a></code></pre></div>
</div>
<div id="model-predictions" class="section level2">
<h2>Model predictions</h2>
<p>If you like to predict a <strong>single new input record</strong>, use <code>predict_pmml()</code> which needs a one row data frame as its data input and the name of the deployed PMML model that should get the prediction. If executed successfully, <code>predict_pmml()</code> returns a list with the following components:</p>
<ul>
<li><p><code>model</code> A length one character vector containing the name of the PMML model that was executed on the server</p></li>
<li><p><code>outputs</code> A data frame containing the prediction results. The values returned depend on the type of prediction model being executed on the server. You can spot the difference between a regression and a classification model in the output below</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">predict_pmml</span>(iris[<span class="dv">42</span>, ], <span class="st">&quot;iris_model&quot;</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; $model</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; [1] &quot;iris_model&quot;</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; $outputs</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt;   Predicted_Sepal.Length</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; 1               6.940802</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="kw">predict_pmml</span>(kyphosis[<span class="dv">23</span>, ], <span class="st">&quot;kyphosis_model&quot;</span>)</a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; $model</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; [1] &quot;kyphosis_model&quot;</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt; $outputs</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt;   Probability_present Probability_absent Predicted_Kyphosis</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt; 1           0.5714286          0.4285714            present</span></a></code></pre></div>
<p>If you like to predict <strong>multiple new input records</strong> all at once, use <code>predict_pmml_batch()</code> which accepts data frames, <code>.csv</code> and <code>.json</code> files as data input. <code>.csv</code> and <code>.json</code> files can even be sent in compressed format (<code>.zip</code> or <code>.gzip</code>).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">predict_pmml_batch</span>(iris[<span class="dv">23</span><span class="op">:</span><span class="dv">25</span>, ], <span class="st">&quot;iris_model&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#&gt; $model</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt; [1] &quot;iris_model&quot;</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#&gt; $outputs</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt;   Predicted_Sepal.Length</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt; 1               6.511500</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; 2               5.351910</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt; 3               6.308676</span></a>
<a class="sourceLine" id="cb9-10" title="10">jsonlite<span class="op">::</span><span class="kw">write_json</span>(iris[<span class="dv">23</span><span class="op">:</span><span class="dv">25</span>, ], <span class="st">&quot;iris.json&quot;</span>)</a>
<a class="sourceLine" id="cb9-11" title="11"><span class="kw">predict_pmml_batch</span>(<span class="st">&quot;iris.json&quot;</span>, <span class="st">&quot;iris_model&quot;</span>)</a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; $model</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; [1] &quot;iris_model&quot;</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">#&gt; $outputs</span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">#&gt;   Predicted_Sepal.Length</span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#&gt; 1               6.511500</span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">#&gt; 2               5.351910</span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#&gt; 3               6.308676</span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="kw">write.csv</span>(iris[<span class="dv">23</span><span class="op">:</span><span class="dv">25</span>, ], <span class="st">&quot;iris.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-21" title="21"><span class="kw">predict_pmml_batch</span>(<span class="st">&quot;iris.csv&quot;</span>,<span class="st">&quot;iris_model&quot;</span>)</a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">#&gt; $model</span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">#&gt; [1] &quot;iris_model&quot;</span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co">#&gt; $outputs</span></a>
<a class="sourceLine" id="cb9-26" title="26"><span class="co">#&gt;   Predicted_Sepal.Length</span></a>
<a class="sourceLine" id="cb9-27" title="27"><span class="co">#&gt; 1               6.511500</span></a>
<a class="sourceLine" id="cb9-28" title="28"><span class="co">#&gt; 2               5.351910</span></a>
<a class="sourceLine" id="cb9-29" title="29"><span class="co">#&gt; 3               6.308676</span></a></code></pre></div>
<p>As you can see by the output above, <code>predict_pmml_batch()</code> also returns a list with the two components <code>model</code> and <code>outputs</code>.</p>
</div>
<div id="downloading-models" class="section level2">
<h2>Downloading models</h2>
<p><code>download_model()</code> lets you download the PMML source of a deployed model. You might choose to download the PMML model source before deleting the model permanently from the server with <code>delete_model()</code> which is described in the next section. <code>download_model()</code> returns a list with two components:</p>
<ul>
<li>The <code>model_name</code> of the downloaded model including the suffix “.pmml”</li>
<li>The <code>model_source</code> represented as an S3 object of class <code>XMLInternalDocument</code> created by parsing the server response using <code>XML::xmlParse()</code></li>
</ul>
<p>After downloading the model of your choice, you can use <code>XML::saveXML()</code> to store it on disk:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">iris_download &lt;-<span class="st"> </span><span class="kw">download_model</span>(<span class="st">&quot;iris_model&quot;</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">XML<span class="op">::</span><span class="kw">saveXML</span>(iris_download[[<span class="st">&quot;model_source&quot;</span>]], <span class="dt">file =</span> iris_download[[<span class="st">&quot;model_name&quot;</span>]])</a></code></pre></div>
<p>Again using some <code>tidyverse</code> ingredients, you can easily download all deployed models at once and store them in a data frame:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"></a>
<a class="sourceLine" id="cb11-2" title="2">downloads &lt;-<span class="st"> </span><span class="kw">get_models</span>() <span class="op">%&gt;%</span><span class="st"> </span>purrr<span class="op">::</span><span class="kw">map</span>(download_model)</a>
<a class="sourceLine" id="cb11-3" title="3"></a>
<a class="sourceLine" id="cb11-4" title="4">tibble<span class="op">::</span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb11-5" title="5">  <span class="dt">model_name =</span> purrr<span class="op">::</span><span class="kw">map_chr</span>(downloads, <span class="st">&quot;model_name&quot;</span>), </a>
<a class="sourceLine" id="cb11-6" title="6">  <span class="dt">source =</span> purrr<span class="op">::</span><span class="kw">map</span>(downloads, <span class="st">&quot;model_source&quot;</span>))</a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt; # A tibble: 2 x 2</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#&gt;   model_name          source    </span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">#&gt;   &lt;chr&gt;               &lt;list&gt;    </span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt; 1 iris_model.pmml     &lt;XMLIntrD&gt;</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#&gt; 2 kyphosis_model.pmml &lt;XMLIntrD&gt;</span></a></code></pre></div>
<p>If you like to store the downloaded models on disk instead, do this:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">purrr<span class="op">::</span><span class="kw">walk2</span>(purrr<span class="op">::</span><span class="kw">map</span>(downloads, <span class="st">&quot;model_source&quot;</span>),</a>
<a class="sourceLine" id="cb12-2" title="2">             purrr<span class="op">::</span><span class="kw">map_chr</span>(downloads, <span class="st">&quot;model_name&quot;</span>),</a>
<a class="sourceLine" id="cb12-3" title="3">             XML<span class="op">::</span>saveXML)</a></code></pre></div>
</div>
<div id="deleting-models" class="section level2">
<h2>Deleting models</h2>
<p>After a PMML model has reached the end of its life cycle you might want to remove it from the server using <code>delete_model</code>() which always returns a character vector with the names of the models still residing deployed to the server:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">delete_model</span>(<span class="st">&quot;iris_model&quot;</span>)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">#&gt; [1] &quot;kyphosis_model&quot;</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw">delete_model</span>(<span class="st">&quot;kyphosis_model&quot;</span>)</a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#&gt; character(0)</span></a></code></pre></div>
</div>
<div id="the-...-argument" class="section level2">
<h2>The <code>...</code> argument</h2>
<p>Each function from the zementisr package comes with a <code>...</code> (dot-dot-dot) argument. It is used to pass on additional arguments to the underlying HTTP method from the <code>httr</code> package. This might be necessary if you need to set some curl options explicitly via <code>httr::config()</code>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
