<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>zementisr Quickstart Guide • zementisr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="zementisr Quickstart Guide">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-55248554-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-55248554-3');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zementisr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/zementisr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/alex23lemm/zementisr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>zementisr Quickstart Guide</h1>
                        <h4 class="author">Alexander Lemm</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/alex23lemm/zementisr/blob/master/vignettes/zementisr.Rmd"><code>vignettes/zementisr.Rmd</code></a></small>
      <div class="hidden name"><code>zementisr.Rmd</code></div>

    </div>

    
    
<p>zementisr is an R client for the Zementis Server API. Zementis Server is an execution engine for PMML models which also comes with model management capabilities.</p>
<p>In this quickstart guide we will show how you can use zementisr to deploy PMML models to Zementis Server, predict new values by sending data to the server and manage the entire PMML model life cycle without leaving your preferred R development environment.</p>
<div id="authentication" class="section level2">
<h2 class="hasAnchor">
<a href="#authentication" class="anchor"></a>Authentication</h2>
<p>Zementis Server’s REST API uses HTTP Basic Authentication. For each request the client needs to provide username and password.</p>
<p>Since typing your password in the console is a bit too dangerous (you might accidentally share the <code>.Rhistory</code> file) and asking each time gets too cumbersome quickly, the zementisr package requires that you store your secrets and the base URL of your Zementis Server as environment variables in the <code>.Renviron</code> file in your home directory.</p>
<p>Please make sure to set the following environment variables accordingly in your <code>.Renviron</code> file before using functions from the zementisr package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ZEMENTIS_base_url =<span class="st"> "http://localhost:9083"</span>
ZEMENTIS_usr =<span class="st"> "guybrush.threepwood"</span>
ZEMENTIS_pwd =<span class="st"> "bigwhoop"</span></code></pre></div>
</div>
<div id="preparation" class="section level2">
<h2 class="hasAnchor">
<a href="#preparation" class="anchor"></a>Preparation</h2>
<p>Before we get started using the zementisr package, we will create two simple prediction models and convert them to PMML using <code>pmml()</code> from the <a href="https://cran.r-project.org/web/packages/pmml/index.html">pmml package</a>. The first PMML model will be saved to disk:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rpart)
<span class="kw">library</span>(pmml)

iris_lm &lt;-<span class="st"> </span><span class="kw">lm</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>iris)
iris_pmml &lt;-<span class="st"> </span><span class="kw">pmml</span>(iris_lm, <span class="dt">model.name =</span> <span class="st">"iris_model"</span>)
<span class="kw">saveXML</span>(iris_pmml, <span class="st">"iris_pmml.xml"</span>)
<span class="co">#&gt; [1] "iris_pmml.xml"</span>

kyphosis_fit &lt;-<span class="st"> </span><span class="kw">rpart</span>(Kyphosis <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Number <span class="op">+</span><span class="st"> </span>Start, <span class="dt">data =</span> kyphosis)
kyphosis_pmml &lt;-<span class="st"> </span><span class="kw">pmml</span>(kyphosis_fit, <span class="dt">model.name =</span> <span class="st">"kyphosis_model"</span>)</code></pre></div>
</div>
<div id="model-deployment" class="section level2">
<h2 class="hasAnchor">
<a href="#model-deployment" class="anchor"></a>Model deployment</h2>
<p>Now, we will start using functions from the zementisr package. We will begin with <code><a href="../reference/upload_model.html">upload_model()</a></code> to upload our PMML models to the server.</p>
<p><code><a href="../reference/upload_model.html">upload_model()</a></code> either accepts a path to a PMML file on disk or an <code>XMLNode</code> object created with <code><a href="http://www.rdocumentation.org/packages/pmml/topics/pmml">pmml::pmml()</a></code>. Below we will demonstrate both options to upload the two models to the server. A successful upload always returns a list with the model name and its activation status.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zementisr)

<span class="kw"><a href="../reference/upload_model.html">upload_model</a></span>(<span class="st">"iris_pmml.xml"</span>)
<span class="co">#&gt; $model_name</span>
<span class="co">#&gt; [1] "iris_model"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $is_active</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="kw"><a href="../reference/upload_model.html">upload_model</a></span>(kyphosis_pmml)
<span class="co">#&gt; $model_name</span>
<span class="co">#&gt; [1] "kyphosis_model"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $is_active</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="basic-model-operations" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-model-operations" class="anchor"></a>Basic model operations</h2>
<p>After deployment you might be interested in how many PMML models are currently deployed to Zementis Server:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_models.html">get_models</a></span>()
<span class="co">#&gt; [1] "iris_model"     "kyphosis_model"</span></code></pre></div>
<p>Use <code><a href="../reference/get_model_properties.html">get_model_properties()</a></code> to get the PMML model’s name, description, input and output field properties:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_model_properties.html">get_model_properties</a></span>(<span class="st">"kyphosis_model"</span>)
<span class="co">#&gt; $modelName</span>
<span class="co">#&gt; [1] "kyphosis_model"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $description</span>
<span class="co">#&gt; [1] "RPart Decision Tree Model"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $isActive</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inputFields</span>
<span class="co">#&gt;     name   type  usage</span>
<span class="co">#&gt; 1    Age DOUBLE ACTIVE</span>
<span class="co">#&gt; 2 Number DOUBLE ACTIVE</span>
<span class="co">#&gt; 3  Start DOUBLE ACTIVE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $outputFields</span>
<span class="co">#&gt;                  name   type  usage</span>
<span class="co">#&gt; 1  Predicted_Kyphosis STRING OUTPUT</span>
<span class="co">#&gt; 2  Probability_absent DOUBLE OUTPUT</span>
<span class="co">#&gt; 3 Probability_present DOUBLE OUTPUT</span></code></pre></div>
<p>If you like to deactivate a PMML model without removing it from the server, do the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/deactivate_model.html">deactivate_model</a></span>(<span class="st">"iris_model"</span>)
<span class="co">#&gt; $model_name</span>
<span class="co">#&gt; [1] "iris_model"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $is_active</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="kw"><a href="../reference/deactivate_model.html">deactivate_model</a></span>(<span class="st">"kyphosis_model"</span>)
<span class="co">#&gt; $model_name</span>
<span class="co">#&gt; [1] "kyphosis_model"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $is_active</span>
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<p>You even can add some <code>magrittr</code> and <code>purrr</code> flavor to chain several zementisr functions together. For instance, the following line of code lets you activate all your PMML models at once:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_models.html">get_models</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/purrr/topics/map">map_df</a></span>(activate_model)
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   model_name     is_active</span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;lgl&gt;    </span>
<span class="co">#&gt; 1 iris_model     TRUE     </span>
<span class="co">#&gt; 2 kyphosis_model TRUE</span></code></pre></div>
</div>
<div id="model-predictions" class="section level2">
<h2 class="hasAnchor">
<a href="#model-predictions" class="anchor"></a>Model predictions</h2>
<p>If you like to predict a <strong>single new input record</strong>, use <code><a href="../reference/apply_model.html">apply_model()</a></code> which needs a one row data frame as its data input and the name of the deployed PMML model that should get the prediction. If executed successfully, <code><a href="../reference/apply_model.html">apply_model()</a></code> returns a list with the following components:</p>
<ul>
<li><p><code>model</code> A length one character vector containing the name of the PMML model that was executed on the server</p></li>
<li><p><code>outputs</code> A data frame containing the prediction results. The values returned depend on the type of prediction model being executed on the server. You can spot the difference between a regression and a classification model in the output below</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/apply_model.html">apply_model</a></span>(iris[<span class="dv">42</span>, ], <span class="st">"iris_model"</span>)
<span class="co">#&gt; $model</span>
<span class="co">#&gt; [1] "iris_model"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $outputs</span>
<span class="co">#&gt;   Predicted_Sepal.Length</span>
<span class="co">#&gt; 1               4.295281</span>
<span class="kw"><a href="../reference/apply_model.html">apply_model</a></span>(kyphosis[<span class="dv">23</span>, ], <span class="st">"kyphosis_model"</span>)
<span class="co">#&gt; $model</span>
<span class="co">#&gt; [1] "kyphosis_model"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $outputs</span>
<span class="co">#&gt;   Probability_present Probability_absent Predicted_Kyphosis</span>
<span class="co">#&gt; 1           0.5714286          0.4285714            present</span></code></pre></div>
<p>If you like to predict a <strong>multiple new input records</strong> all at once, use <code><a href="../reference/apply_model_batch.html">apply_model_batch()</a></code> which accepts data frames, <code>.csv</code> and <code>.json</code> files as data input. <code>.csv</code> and <code>.json</code> files can even be sent in compressed format (<code>.zip</code> or <code>.gzip</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/apply_model_batch.html">apply_model_batch</a></span>(iris[<span class="dv">23</span><span class="op">:</span><span class="dv">25</span>, ], <span class="st">"iris_model"</span>)
<span class="co">#&gt; $model</span>
<span class="co">#&gt; [1] "iris_model"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $outputs</span>
<span class="co">#&gt;   Predicted_Sepal.Length</span>
<span class="co">#&gt; 1               4.722679</span>
<span class="co">#&gt; 2               5.059837</span>
<span class="co">#&gt; 3               5.369821</span>
jsonlite<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/jsonlite/topics/read_json">write_json</a></span>(iris[<span class="dv">23</span><span class="op">:</span><span class="dv">25</span>, ], <span class="st">"iris.json"</span>)
<span class="kw"><a href="../reference/apply_model_batch.html">apply_model_batch</a></span>(<span class="st">"iris.json"</span>, <span class="st">"iris_model"</span>)
<span class="co">#&gt; $model</span>
<span class="co">#&gt; [1] "iris_model"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $outputs</span>
<span class="co">#&gt;   Predicted_Sepal.Length</span>
<span class="co">#&gt; 1               4.722679</span>
<span class="co">#&gt; 2               5.059837</span>
<span class="co">#&gt; 3               5.369821</span>
<span class="kw">write.csv</span>(iris[<span class="dv">23</span><span class="op">:</span><span class="dv">25</span>, ], <span class="st">"iris.csv"</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)
<span class="kw"><a href="../reference/apply_model_batch.html">apply_model_batch</a></span>(<span class="st">"iris.csv"</span>,<span class="st">"iris_model"</span>)
<span class="co">#&gt; $model</span>
<span class="co">#&gt; [1] "iris_model"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $outputs</span>
<span class="co">#&gt;   Predicted_Sepal.Length</span>
<span class="co">#&gt; 1               4.722679</span>
<span class="co">#&gt; 2               5.059837</span>
<span class="co">#&gt; 3               5.369821</span></code></pre></div>
<p>As you can see by the output above, <code><a href="../reference/apply_model_batch.html">apply_model_batch()</a></code> also returns a list with the two components <code>model</code> and <code>outputs</code>.</p>
</div>
<div id="delete-models" class="section level2">
<h2 class="hasAnchor">
<a href="#delete-models" class="anchor"></a>Delete models</h2>
<p>After a PMML model has reached the end of its life cycle you might want to remove it from the server using <code>delete_model</code>() which always returns a character vector with the names of the models still residing deployed to the server:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/delete_model.html">delete_model</a></span>(<span class="st">"iris_model"</span>)
<span class="co">#&gt; [1] "kyphosis_model"</span>
<span class="kw"><a href="../reference/delete_model.html">delete_model</a></span>(<span class="st">"kyphosis_model"</span>)
<span class="co">#&gt; character(0)</span></code></pre></div>
</div>
<div id="the-----argument" class="section level2">
<h2 class="hasAnchor">
<a href="#the-----argument" class="anchor"></a>The <code>...</code> argument</h2>
<p>Each function from the zementisr package comes with a <code>...</code> (dot-dot-dot) argument. It is used to pass on additional arguments to the underlying HTTP method from the <code>httr</code> package. This might be necessary if you need to set some curl options explicitly via <code><a href="http://www.rdocumentation.org/packages/httr/topics/config">httr::config()</a></code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#authentication">Authentication</a></li>
      <li><a href="#preparation">Preparation</a></li>
      <li><a href="#model-deployment">Model deployment</a></li>
      <li><a href="#basic-model-operations">Basic model operations</a></li>
      <li><a href="#model-predictions">Model predictions</a></li>
      <li><a href="#delete-models">Delete models</a></li>
      <li><a href="#the-----argument">The <code>...</code> argument</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Alexander Lemm.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
